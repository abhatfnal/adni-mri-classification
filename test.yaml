datamodule:
  class: pkg.data.datamodules.ADNIDataModule
  args:
    data:
      scan_csv: /project/aereditato/cestari/adni-mri-classification/data/preprocessing_multimodal/dataset_multimodal.csv
      diagnostic_csv: /project/aereditato/cestari/adni-mri-classification/data/preprocessing_multimodal/tables/DXSUM_02Feb2026.csv
      diagnosis: [1,2,3]
      tolerance: 180
      modalities:
        MRI: ["MRI-T1-3T", "MRI-T1-1.5T"]
        PET: ["PET-FDG"]
    split:
      mode: kfold
      seed: 42
      folds: 5
      test_size: 0.1
      val_size: 0.2
    loader:
      batch_size: 4
      weighted_sampling: true
    transform:
      - random_flip:
          p: 0.5
      - random_affine:
          p: 0.5
          degrees: 5
          translation: 5
      - random_noise:
          p: 0.2
          std: 0.02

model:
  class: pkg.models.model_resnet18.ResNet18
  args:
    cfg:
      init_filters: 8
      dropout: 0.3
      num_classes: 3

optimizer:
  name: AdamW
  params:
    lr: 0.0001
    weight_decay: 0.01

criterion:
  name: CrossEntropyLoss
  weights: auto
  params: {}
        
task:
  class: pkg.tasks.classification.ClassificationTask
  args:
    output_mode: multiclass # | binary 
    
trainer:
  max_epochs: 100
  device: cuda

callbacks:
  - class: pkg.callbacks.metrics.Metrics
    args:
      metrics:
        - class: pkg.metrics.scalar.ScalarMetric
          args:
            key: loss

        - class: pkg.metrics.accuracy.Accuracy
          args: {}

  - class: pkg.callbacks.checkpoint.CheckpointManager
    args: 
      monitor: val/loss
      mode: min 
      patience: 10

  - class: pkg.callbacks.scheduler.SchedulerPolicy
    args: 
      name: ReduceLROnPlateau





 



  
        